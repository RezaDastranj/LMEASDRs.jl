<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analysing ASDRs with MixedModels.jl · LMEASDRs</title><meta name="title" content="Analysing ASDRs with MixedModels.jl · LMEASDRs"/><meta property="og:title" content="Analysing ASDRs with MixedModels.jl · LMEASDRs"/><meta property="twitter:title" content="Analysing ASDRs with MixedModels.jl · LMEASDRs"/><meta name="description" content="Documentation for LMEASDRs."/><meta property="og:description" content="Documentation for LMEASDRs."/><meta property="twitter:description" content="Documentation for LMEASDRs."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="LMEASDRs logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">LMEASDRs</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Analysing ASDRs with MixedModels.jl</a><ul class="internal"><li><a class="tocitem" href="#Insights-through-ASDRs:-Visualizing-Age-Specific-Death-Rates"><span>Insights through ASDRs: Visualizing Age-Specific Death Rates</span></a></li><li><a class="tocitem" href="#Modelling-ASDRs-using-MixedModels.jl"><span>Modelling ASDRs using MixedModels.jl</span></a></li><li><a class="tocitem" href="#Check-for-Heteroskedasticity-and-Assess-Normality"><span>Check for Heteroskedasticity and Assess Normality</span></a></li><li><a class="tocitem" href="#Refine-the-Model"><span>Refine the Model</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../bootstrap/">Parametric bootstrap for LMEASDRs</a></li><li><a class="tocitem" href="../parameter-estimation/">The parameter estimation</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Analysing ASDRs with MixedModels.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analysing ASDRs with MixedModels.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RezaDastranj/LMEASDRs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RezaDastranj/LMEASDRs.jl/blob/main/docs/src/LME.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Analysing-Age-Specific-Death-Rates-with-MixedModels.jl"><a class="docs-heading-anchor" href="#Analysing-Age-Specific-Death-Rates-with-MixedModels.jl">Analysing Age-Specific Death Rates with MixedModels.jl</a><a id="Analysing-Age-Specific-Death-Rates-with-MixedModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Analysing-Age-Specific-Death-Rates-with-MixedModels.jl" title="Permalink"></a></h1><p>We construct ASDRs data as explained here: <a href="https://rezadastranj.github.io/LME-ASDRs">ASDRs</a>. After saving in RDA format in R, we load the data in Julia.</p><pre><code class="language-julia hljs">using RData

# Specify the path to the RDA file containing ASDRs data
rdanm = &quot;ASDRs.rda&quot;

# Check the size of the RDA file
filesize(rdanm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">93127</code></pre><p>We convert the data to <code>Arrow</code> format. Arrow is optimized for in-memory analytics, and its columnar format can lead to more efficient memory usage. This can be important when working with large datasets or when dealing with memory-intensive operations, such as fitting mixed-effects models.</p><pre><code class="language-julia hljs">using Arrow, DataFrames
# Load ASDRs data from the RDA file
ASDRs = load(rdanm)

# Data preprocessing
ASDRs[&quot;age&quot;] = Arrow.DictEncode(lpad.(ASDRs[&quot;age&quot;], 3, &#39;0&#39;))
ASDRs[&quot;gender&quot;] = Arrow.DictEncode(ASDRs[&quot;gender&quot;])
ASDRs[&quot;Country&quot;] = Arrow.DictEncode(ASDRs[&quot;Country&quot;])
ASDRs[&quot;cohort&quot;] = Int16.(ASDRs[&quot;cohort&quot;])
ASDRs[&quot;year&quot;] = Int16.(ASDRs[&quot;year&quot;])

# Write the data to Arrow format with Zstandard compression
arrownm = Arrow.write(&quot;./ASDRs.arrow&quot;, DataFrame(ASDRs); compress=:zstd)

# Check the size of the Arrow file
filesize(arrownm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">80914</code></pre><pre><code class="language-julia hljs"># Load the Arrow data stored in the file &#39;arrownm&#39; into a DataFrame
df = DataFrame(Arrow.Table(arrownm))

# Display a summary of the DataFrame, including statistics and information about each column
describe(df)</code></pre><div><div style = "float: left;"><span>10×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">variable</th><th style = "text-align: left;">mean</th><th style = "text-align: left;">min</th><th style = "text-align: left;">median</th><th style = "text-align: left;">max</th><th style = "text-align: left;">nmissing</th><th style = "text-align: left;">eltype</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Symbol" style = "text-align: left;">Symbol</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "DataType" style = "text-align: left;">DataType</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Country</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">AUT</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">SWE</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">age</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">000</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">110</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">cohort</td><td style = "text-align: left;">1932.75</td><td style = "text-align: left;">1851</td><td style = "text-align: left;">1933.0</td><td style = "text-align: left;">2010</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Int16</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">gender</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">Female</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">Male</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">k1</td><td style = "text-align: left;">-4.54479</td><td style = "text-align: left;">-5.01632</td><td style = "text-align: left;">-4.50864</td><td style = "text-align: left;">-4.21601</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">k2</td><td style = "text-align: left;">20.7114</td><td style = "text-align: left;">17.7747</td><td style = "text-align: left;">20.3279</td><td style = "text-align: left;">25.1635</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">kc1</td><td style = "text-align: left;">-4.54479</td><td style = "text-align: left;">-8.02374</td><td style = "text-align: left;">-2.91998</td><td style = "text-align: left;">-2.34216</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">kc2</td><td style = "text-align: left;">25.5771</td><td style = "text-align: left;">5.48573</td><td style = "text-align: left;">8.5263</td><td style = "text-align: left;">64.3805</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">y</td><td style = "text-align: left;">-4.54479</td><td style = "text-align: left;">-10.1266</td><td style = "text-align: left;">-4.81651</td><td style = "text-align: left;">-0.13801</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">year</td><td style = "text-align: left;">1985.5</td><td style = "text-align: left;">1961</td><td style = "text-align: left;">1985.5</td><td style = "text-align: left;">2010</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Int16</td></tr></tbody></table></div><pre><code class="language-julia hljs"># Create a new column &#39;cgx&#39; in the DataFrame by combining &#39;Country&#39;, &#39;gender&#39;, and &#39;age&#39; columns
df[!, :cgx] = df.Country .* df.gender .* df.age

# Display a summary of the DataFrame after adding the new &#39;cgx&#39; column
first(df, 6)  # Display the first 6 rows</code></pre><div><div style = "float: left;"><span>6×11 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Country</th><th style = "text-align: left;">age</th><th style = "text-align: left;">cohort</th><th style = "text-align: left;">gender</th><th style = "text-align: left;">k1</th><th style = "text-align: left;">k2</th><th style = "text-align: left;">kc1</th><th style = "text-align: left;">kc2</th><th style = "text-align: left;">y</th><th style = "text-align: left;">year</th><th style = "text-align: left;">cgx</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Int16" style = "text-align: left;">Int16</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int16" style = "text-align: left;">Int16</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1961</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.24593</td><td style = "text-align: right;">18.0279</td><td style = "text-align: right;">-6.46623</td><td style = "text-align: right;">41.8122</td><td style = "text-align: right;">-3.52574</td><td style = "text-align: right;">1961</td><td style = "text-align: left;">AUTFemale000</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1962</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.21601</td><td style = "text-align: right;">17.7747</td><td style = "text-align: right;">-6.49718</td><td style = "text-align: right;">42.2134</td><td style = "text-align: right;">-3.51124</td><td style = "text-align: right;">1962</td><td style = "text-align: left;">AUTFemale000</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1963</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.2279</td><td style = "text-align: right;">17.8752</td><td style = "text-align: right;">-6.50177</td><td style = "text-align: right;">42.273</td><td style = "text-align: right;">-3.56702</td><td style = "text-align: right;">1963</td><td style = "text-align: left;">AUTFemale000</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1964</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.26258</td><td style = "text-align: right;">18.1696</td><td style = "text-align: right;">-6.50632</td><td style = "text-align: right;">42.3321</td><td style = "text-align: right;">-3.66321</td><td style = "text-align: right;">1964</td><td style = "text-align: left;">AUTFemale000</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1965</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.25517</td><td style = "text-align: right;">18.1064</td><td style = "text-align: right;">-6.54815</td><td style = "text-align: right;">42.8783</td><td style = "text-align: right;">-3.67065</td><td style = "text-align: right;">1965</td><td style = "text-align: left;">AUTFemale000</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">AUT</td><td style = "text-align: left;">000</td><td style = "text-align: right;">1966</td><td style = "text-align: left;">Female</td><td style = "text-align: right;">-4.26593</td><td style = "text-align: right;">18.1981</td><td style = "text-align: right;">-6.52569</td><td style = "text-align: right;">42.5846</td><td style = "text-align: right;">-3.71317</td><td style = "text-align: right;">1966</td><td style = "text-align: left;">AUTFemale000</td></tr></tbody></table></div><pre><code class="language-julia hljs"># Display a summary of the DataFrame after adding the new &#39;cgx&#39; column
last(df, 6)   # Display the last 6 rows</code></pre><div><div style = "float: left;"><span>6×11 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Country</th><th style = "text-align: left;">age</th><th style = "text-align: left;">cohort</th><th style = "text-align: left;">gender</th><th style = "text-align: left;">k1</th><th style = "text-align: left;">k2</th><th style = "text-align: left;">kc1</th><th style = "text-align: left;">kc2</th><th style = "text-align: left;">y</th><th style = "text-align: left;">year</th><th style = "text-align: left;">cgx</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Int16" style = "text-align: left;">Int16</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int16" style = "text-align: left;">Int16</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1895</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-4.89791</td><td style = "text-align: right;">23.9895</td><td style = "text-align: right;">-3.01477</td><td style = "text-align: right;">9.08884</td><td style = "text-align: right;">-0.211376</td><td style = "text-align: right;">2005</td><td style = "text-align: left;">SWEMale110</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1896</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-4.92707</td><td style = "text-align: right;">24.276</td><td style = "text-align: right;">-3.03642</td><td style = "text-align: right;">9.21982</td><td style = "text-align: right;">-0.221582</td><td style = "text-align: right;">2006</td><td style = "text-align: left;">SWEMale110</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1897</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-4.94757</td><td style = "text-align: right;">24.4785</td><td style = "text-align: right;">-3.04139</td><td style = "text-align: right;">9.25004</td><td style = "text-align: right;">-0.206139</td><td style = "text-align: right;">2007</td><td style = "text-align: left;">SWEMale110</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1898</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-4.97004</td><td style = "text-align: right;">24.7013</td><td style = "text-align: right;">-3.05806</td><td style = "text-align: right;">9.35174</td><td style = "text-align: right;">-0.217124</td><td style = "text-align: right;">2008</td><td style = "text-align: left;">SWEMale110</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1899</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-4.97096</td><td style = "text-align: right;">24.7104</td><td style = "text-align: right;">-3.07419</td><td style = "text-align: right;">9.45064</td><td style = "text-align: right;">-0.202581</td><td style = "text-align: right;">2009</td><td style = "text-align: left;">SWEMale110</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">SWE</td><td style = "text-align: left;">110</td><td style = "text-align: right;">1900</td><td style = "text-align: left;">Male</td><td style = "text-align: right;">-5.01632</td><td style = "text-align: right;">25.1635</td><td style = "text-align: right;">-3.09239</td><td style = "text-align: right;">9.56288</td><td style = "text-align: right;">-0.213156</td><td style = "text-align: right;">2010</td><td style = "text-align: left;">SWEMale110</td></tr></tbody></table></div><h2 id="Insights-through-ASDRs:-Visualizing-Age-Specific-Death-Rates"><a class="docs-heading-anchor" href="#Insights-through-ASDRs:-Visualizing-Age-Specific-Death-Rates">Insights through ASDRs: Visualizing Age-Specific Death Rates</a><a id="Insights-through-ASDRs:-Visualizing-Age-Specific-Death-Rates-1"></a><a class="docs-heading-anchor-permalink" href="#Insights-through-ASDRs:-Visualizing-Age-Specific-Death-Rates" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Import the Gadfly library for plotting
using Gadfly

# Define a subset of the DataFrame based on specific conditions (Country, gender, and age groups)
subset_df = filter(row -&gt; row.Country == &quot;CZE&quot; &amp;&amp; row.gender == &quot;Male&quot; &amp;&amp; row.age in [&quot;000&quot;, &quot;010&quot;, &quot;020&quot;, &quot;040&quot;, &quot;050&quot;, &quot;060&quot;, &quot;070&quot;, &quot;080&quot;], df)

# Create a dark-themed plot using Gadfly
Gadfly.with_theme(:dark) do
    Gadfly.plot(
        subset_df,                  # DataFrame to be plotted
        x=:year,                    # X-axis corresponds to the &#39;year&#39; column
        y=:y,                       # Y-axis corresponds to the &#39;y&#39; column
        color=:age,                 # Color differentiation based on the &#39;age&#39; column
        Geom.point,                  # Point geometry for data points
        Geom.line,                   # Line geometry for connecting data points
        linestyle=[:dash],           # Dash linestyle for lines
        size=[1.72pt],               # Set point size
        Guide.xlabel(&quot;Year&quot;),        # X-axis label
        Guide.ylabel(&quot;Mortality(log)&quot;),  # Y-axis label
        Guide.colorkey(title=&quot;Age&quot;)  # Color key title
    )
end</code></pre><img src="7ef10f2d.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Define a subset of the DataFrame based on specific conditions (Country, gender, and age groups)
subset_df = filter(row -&gt; row.Country == &quot;AUT&quot; &amp;&amp; row.gender == &quot;Male&quot; &amp;&amp; row.age in [&quot;000&quot;, &quot;010&quot;, &quot;020&quot;, &quot;040&quot;, &quot;050&quot;, &quot;060&quot;, &quot;070&quot;, &quot;080&quot;], df)

# Define custom LaTeX fonts for Gadfly plot aesthetics
latex_fonts = Gadfly.Theme(
    major_label_font=&quot;CMU Serif&quot;,             # Major label font type
    major_label_font_size=16pt,               # Major label font size
    minor_label_font=&quot;CMU Serif&quot;,             # Minor label font type
    minor_label_font_size=14pt,               # Minor label font size
    key_title_font=&quot;CMU Serif&quot;,               # Key title font type
    key_title_font_size=12pt,                 # Key title font size
    key_label_font=&quot;CMU Serif&quot;,               # Key label font type
    key_label_font_size=10pt                  # Key label font size
)

# Apply the custom LaTeX fonts to the Gadfly theme
Gadfly.push_theme(latex_fonts)

# Create a Gadfly plot with the customized theme
Gadfly.plot(
    subset_df,                              # DataFrame to be plotted
    x=:year,                                # X-axis corresponds to the &#39;year&#39; column
    y=:y,                                   # Y-axis corresponds to the &#39;y&#39; column
    color=:age,                             # Color differentiation based on the &#39;age&#39; column
    Geom.point,                             # Point geometry for data points
    Geom.line,                              # Line geometry for connecting data points
    linestyle=[:dash],                      # Dash linestyle for lines
    size=[1.72pt],                          # Set point size
    Guide.xlabel(&quot;Year&quot;),                   # X-axis label
    Guide.ylabel(&quot;Mortality(log)&quot;),         # Y-axis label
    Guide.colorkey(title=&quot;Age&quot;)             # Color key title
)</code></pre><img src="455c0d89.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Apply a dark theme to Gadfly for improved visualization in a dark background
Gadfly.with_theme(:dark) do
    # Set the default plot size to 14cm x 8cm
    set_default_plot_size(14cm, 8cm)

    # Create a Gadfly violin plot
    Gadfly.plot(
        df,                         # DataFrame to be plotted
        x=:Country,                 # X-axis corresponds to the &#39;Country&#39; column
        y=:y,                       # Y-axis corresponds to the &#39;y&#39; column
        color=:Country,             # Color differentiation based on the &#39;Country&#39; column
        Geom.violin                 # Violin geometry for displaying distribution
    )
end</code></pre><img src="6917c49c.svg" alt="Example block output"/><h2 id="Modelling-ASDRs-using-MixedModels.jl"><a class="docs-heading-anchor" href="#Modelling-ASDRs-using-MixedModels.jl">Modelling ASDRs using MixedModels.jl</a><a id="Modelling-ASDRs-using-MixedModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-ASDRs-using-MixedModels.jl" title="Permalink"></a></h2><p>We use the <code>MixedModels.jl</code> package to fit a linear mixed-effects model to mortality data. We consider a general model with random effects specified for &#39;cgx&#39; grouping variable. <code>REML</code> (Restricted Maximum Likelihood) is employed for parameter estimation:</p><pre><code class="language-julia hljs">using MixedModels

# Define the contrasts for categorical variables
contrasts = Dict(:cgx =&gt; Grouping());

# Define the formula for the linear mixed-effects model
f = @formula y ~ age + gender&amp;age + gender&amp;age&amp;kc1 + gender&amp;age&amp;kc2 + k1 + k2 + cohort + (k1 + k2 + cohort | cgx);

# Fit the model using the specified formula, DataFrame &#39;df&#39;, and REML estimation

m1 = fit(MixedModel, f, df, REML=true; contrasts);

VarCorr(m1)</code></pre><table><tr><th align="left"> </th><th align="left">Column</th><th align="right"> Variance</th><th align="right">Std.Dev</th><th align="right">Corr.</th><th align="right"> </th><th align="right"> </th></tr><tr><td align="left">cgx</td><td align="left">&#40;Intercept&#41;</td><td align="right">0.007298037</td><td align="right">0.085428548</td><td align="right"> </td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">k1</td><td align="right">0.007055093</td><td align="right">0.083994600</td><td align="right">&#43;0.01</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">k2</td><td align="right">0.000755345</td><td align="right">0.027483539</td><td align="right">-0.00</td><td align="right">&#43;0.22</td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">cohort</td><td align="right">0.000000112</td><td align="right">0.000334676</td><td align="right">-0.21</td><td align="right">&#43;0.45</td><td align="right">-0.74</td></tr><tr><td align="left">Residual</td><td align="left"> </td><td align="right">0.006606009</td><td align="right">0.081277360</td><td align="right"> </td><td align="right"> </td><td align="right"> </td></tr></table>
<div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The random effects are designed with a mean of 0, which means that any non-zero mean for a term in the random effects must be integrated into the fixed-effects terms. Consequently, we may need to consider incorporating new covariates as fixed effects if warranted. <a href="https://link.springer.com/chapter/10.1007/0-387-22747-4_2">Mixed-Effects Models in S and S-PLUS</a></p></div></div><p>Determine the floating-point type used internally for the matrices, vectors, and scalars in the model. The type of &#39;m1&#39; represents the internal floating-point type for parameter optimization. Currently, the NLopt package is used for optimization, allowing only Float64 for parameter vectors. In theory, other floating-point types like BigFloat or Float32 can be used, but only Float64 works in practice.</p><pre><code class="language-julia hljs">typeof(m1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixedModels.LinearMixedModel{Float64}</code></pre><pre><code class="language-julia hljs"># Generate fitted values and residuals from the linear mixed effects model &#39;m1&#39;
df.fitted = predict(m1)        # Fitted values
df.residuals = residuals(m1)    # Residuals</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">14400-element Vector{Float64}:
  0.008583691752984013
  0.1021226681317291
  0.0597606244254405
 -0.02033260811788562
  0.0799468717308982
 -0.019501754860921316
 -0.08093821946111923
  0.026436452452148984
 -0.09641011647554354
 -0.07905470761167832
  ⋮
  0.04509748460218008
  0.002427574820262318
 -0.0009399265907085175
  0.008084745130364196
 -0.009877879905735798
  0.0035657519495298495
 -0.013942648298167243
 -0.005906896576174825
 -0.024574799381339274</code></pre><h2 id="Check-for-Heteroskedasticity-and-Assess-Normality"><a class="docs-heading-anchor" href="#Check-for-Heteroskedasticity-and-Assess-Normality">Check for Heteroskedasticity and Assess Normality</a><a id="Check-for-Heteroskedasticity-and-Assess-Normality-1"></a><a class="docs-heading-anchor-permalink" href="#Check-for-Heteroskedasticity-and-Assess-Normality" title="Permalink"></a></h2><p>Scatter plot to check for <code>heteroskedasticity</code></p><pre><code class="language-julia hljs"># Scatter plot of residuals against fitted values with highlighting
Gadfly.plot(
    y = df.residuals,
    x = df.fitted,
    Geom.point,
    Gadfly.Theme(discrete_highlight_color=x -&gt; &quot;red&quot;, default_color=&quot;white&quot;),
    Guide.xlabel(&quot;Fitted Values&quot;),
    Guide.ylabel(&quot;Residuals&quot;),
    Guide.title(&quot;Scatter Plot for Heteroskedasticity&quot;)
)</code></pre><img src="aba7e769.svg" alt="Example block output"/><pre><code class="language-julia hljs">using Statistics
# QQ plot for residuals with fitted normal distribution
Gadfly.plot(
    x = df.residuals,
    y = Normal(mean(df.residuals), std(df.residuals)),
    Stat.qq,
    Geom.point,
    Gadfly.Theme(discrete_highlight_color=c -&gt; nothing, alphas=[0.5], point_size=2pt)
)</code></pre><img src="a3c9b530.svg" alt="Example block output"/><h2 id="Refine-the-Model"><a class="docs-heading-anchor" href="#Refine-the-Model">Refine the Model</a><a id="Refine-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Refine-the-Model" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Filter out data points with absolute residuals outside the range [-0.10, 0.10]
df_filtered = df[abs.(df.residuals) .&lt;= 0.10, :]

# Write the data to Arrow format with Zstandard compression
Arrow.write(&quot;./df_filtered.arrow&quot;, DataFrame(df_filtered); compress=:zstd)

# Fit a linear mixed-effects model with a reduced dataset
m2 = let
    f = @formula y ~ age + gender&amp;age + gender&amp;age&amp;kc1 + gender&amp;age&amp;kc2 + k2 + cohort + (k2 + cohort | cgx)
    fit(MixedModel, f, df_filtered, REML=true; contrasts)
end</code></pre><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_cgx</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">52.0056</td><td align="right">1.4800</td><td align="right">35.14</td><td align="right">&lt;1e-99</td><td align="right">0.0453</td></tr><tr><td align="left">age: 001</td><td align="right">-25.2158</td><td align="right">2.0514</td><td align="right">-12.29</td><td align="right">&lt;1e-34</td><td align="right"> </td></tr><tr><td align="left">age: 005</td><td align="right">-22.0472</td><td align="right">2.1575</td><td align="right">-10.22</td><td align="right">&lt;1e-23</td><td align="right"> </td></tr><tr><td align="left">age: 010</td><td align="right">-45.3909</td><td align="right">2.1513</td><td align="right">-21.10</td><td align="right">&lt;1e-98</td><td align="right"> </td></tr><tr><td align="left">age: 015</td><td align="right">-56.5856</td><td align="right">2.0795</td><td align="right">-27.21</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 020</td><td align="right">-62.9992</td><td align="right">2.0433</td><td align="right">-30.83</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 025</td><td align="right">-56.6531</td><td align="right">1.9776</td><td align="right">-28.65</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 030</td><td align="right">-62.9784</td><td align="right">1.9562</td><td align="right">-32.19</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 035</td><td align="right">-63.8633</td><td align="right">1.9457</td><td align="right">-32.82</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 040</td><td align="right">-64.6277</td><td align="right">1.8880</td><td align="right">-34.23</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 045</td><td align="right">-55.9600</td><td align="right">1.6824</td><td align="right">-33.26</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 050</td><td align="right">-50.5690</td><td align="right">1.6764</td><td align="right">-30.16</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 055</td><td align="right">-48.3654</td><td align="right">1.6751</td><td align="right">-28.87</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 060</td><td align="right">-45.1186</td><td align="right">1.6801</td><td align="right">-26.85</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 065</td><td align="right">-45.5294</td><td align="right">1.6765</td><td align="right">-27.16</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 070</td><td align="right">-45.5452</td><td align="right">1.6704</td><td align="right">-27.27</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 075</td><td align="right">-45.5710</td><td align="right">1.6716</td><td align="right">-27.26</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 080</td><td align="right">-46.6556</td><td align="right">1.6743</td><td align="right">-27.87</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 085</td><td align="right">-46.1616</td><td align="right">1.6708</td><td align="right">-27.63</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 090</td><td align="right">-46.7180</td><td align="right">1.6718</td><td align="right">-27.94</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 095</td><td align="right">-46.9024</td><td align="right">1.6702</td><td align="right">-28.08</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 100</td><td align="right">-47.6620</td><td align="right">1.6703</td><td align="right">-28.53</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 105</td><td align="right">-48.5087</td><td align="right">1.6704</td><td align="right">-29.04</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">age: 110</td><td align="right">-49.1755</td><td align="right">1.6705</td><td align="right">-29.44</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">k2</td><td align="right">0.0065</td><td align="right">0.0027</td><td align="right">2.44</td><td align="right">0.0147</td><td align="right">0.0266</td></tr><tr><td align="left">cohort</td><td align="right">-0.0010</td><td align="right">0.0002</td><td align="right">-4.36</td><td align="right">&lt;1e-04</td><td align="right">0.0003</td></tr><tr><td align="left">gender: Male &amp; age: 000</td><td align="right">-1.8669</td><td align="right">2.0252</td><td align="right">-0.92</td><td align="right">0.3566</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 001</td><td align="right">1.6885</td><td align="right">2.0003</td><td align="right">0.84</td><td align="right">0.3986</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 005</td><td align="right">-8.9742</td><td align="right">2.2798</td><td align="right">-3.94</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 010</td><td align="right">3.8349</td><td align="right">2.1230</td><td align="right">1.81</td><td align="right">0.0709</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 015</td><td align="right">-12.5154</td><td align="right">2.0087</td><td align="right">-6.23</td><td align="right">&lt;1e-09</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 020</td><td align="right">-13.4794</td><td align="right">1.9847</td><td align="right">-6.79</td><td align="right">&lt;1e-10</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 025</td><td align="right">-17.8404</td><td align="right">1.9025</td><td align="right">-9.38</td><td align="right">&lt;1e-20</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 030</td><td align="right">-15.9348</td><td align="right">1.8379</td><td align="right">-8.67</td><td align="right">&lt;1e-17</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 035</td><td align="right">-11.1882</td><td align="right">1.7468</td><td align="right">-6.40</td><td align="right">&lt;1e-09</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 040</td><td align="right">-13.2583</td><td align="right">1.7025</td><td align="right">-7.79</td><td align="right">&lt;1e-14</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 045</td><td align="right">-4.8221</td><td align="right">1.1716</td><td align="right">-4.12</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 050</td><td align="right">-6.2873</td><td align="right">1.1598</td><td align="right">-5.42</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 055</td><td align="right">-6.4181</td><td align="right">1.1442</td><td align="right">-5.61</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 060</td><td align="right">-10.6668</td><td align="right">1.1569</td><td align="right">-9.22</td><td align="right">&lt;1e-19</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 065</td><td align="right">-13.5902</td><td align="right">1.1489</td><td align="right">-11.83</td><td align="right">&lt;1e-31</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 070</td><td align="right">-14.9685</td><td align="right">1.1350</td><td align="right">-13.19</td><td align="right">&lt;1e-38</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 075</td><td align="right">-14.2209</td><td align="right">1.1303</td><td align="right">-12.58</td><td align="right">&lt;1e-35</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 080</td><td align="right">-10.2222</td><td align="right">1.1331</td><td align="right">-9.02</td><td align="right">&lt;1e-18</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 085</td><td align="right">-6.0201</td><td align="right">1.1285</td><td align="right">-5.33</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 090</td><td align="right">-2.2373</td><td align="right">1.1302</td><td align="right">-1.98</td><td align="right">0.0478</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 095</td><td align="right">0.0779</td><td align="right">1.1290</td><td align="right">0.07</td><td align="right">0.9450</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 100</td><td align="right">1.8909</td><td align="right">1.1297</td><td align="right">1.67</td><td align="right">0.0942</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 105</td><td align="right">2.9258</td><td align="right">1.1291</td><td align="right">2.59</td><td align="right">0.0096</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 110</td><td align="right">3.1015</td><td align="right">1.1295</td><td align="right">2.75</td><td align="right">0.0060</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 000 &amp; kc1</td><td align="right">13.8323</td><td align="right">0.4139</td><td align="right">33.42</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 000 &amp; kc1</td><td align="right">13.2169</td><td align="right">0.3921</td><td align="right">33.70</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 001 &amp; kc1</td><td align="right">7.6371</td><td align="right">0.4062</td><td align="right">18.80</td><td align="right">&lt;1e-78</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 001 &amp; kc1</td><td align="right">8.0529</td><td align="right">0.3908</td><td align="right">20.61</td><td align="right">&lt;1e-93</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 005 &amp; kc1</td><td align="right">8.8194</td><td align="right">0.4456</td><td align="right">19.79</td><td align="right">&lt;1e-86</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 005 &amp; kc1</td><td align="right">6.0275</td><td align="right">0.4575</td><td align="right">13.17</td><td align="right">&lt;1e-38</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 010 &amp; kc1</td><td align="right">2.7364</td><td align="right">0.4408</td><td align="right">6.21</td><td align="right">&lt;1e-09</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 010 &amp; kc1</td><td align="right">3.4609</td><td align="right">0.4020</td><td align="right">8.61</td><td align="right">&lt;1e-17</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 015 &amp; kc1</td><td align="right">-0.2716</td><td align="right">0.4101</td><td align="right">-0.66</td><td align="right">0.5077</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 015 &amp; kc1</td><td align="right">-4.0851</td><td align="right">0.3832</td><td align="right">-10.66</td><td align="right">&lt;1e-25</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 020 &amp; kc1</td><td align="right">-2.1004</td><td align="right">0.4051</td><td align="right">-5.18</td><td align="right">&lt;1e-06</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 020 &amp; kc1</td><td align="right">-6.1558</td><td align="right">0.3918</td><td align="right">-15.71</td><td align="right">&lt;1e-54</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 025 &amp; kc1</td><td align="right">-0.4729</td><td align="right">0.3768</td><td align="right">-1.26</td><td align="right">0.2094</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 025 &amp; kc1</td><td align="right">-5.5820</td><td align="right">0.3908</td><td align="right">-14.28</td><td align="right">&lt;1e-45</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 030 &amp; kc1</td><td align="right">-2.2620</td><td align="right">0.3680</td><td align="right">-6.15</td><td align="right">&lt;1e-09</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 030 &amp; kc1</td><td align="right">-6.8676</td><td align="right">0.3682</td><td align="right">-18.65</td><td align="right">&lt;1e-76</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 035 &amp; kc1</td><td align="right">-2.5799</td><td align="right">0.3632</td><td align="right">-7.10</td><td align="right">&lt;1e-11</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 035 &amp; kc1</td><td align="right">-5.8402</td><td align="right">0.3357</td><td align="right">-17.40</td><td align="right">&lt;1e-67</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 040 &amp; kc1</td><td align="right">-2.7659</td><td align="right">0.3371</td><td align="right">-8.20</td><td align="right">&lt;1e-15</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 040 &amp; kc1</td><td align="right">-6.6506</td><td align="right">0.3446</td><td align="right">-19.30</td><td align="right">&lt;1e-82</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 045 &amp; kc1</td><td align="right">-0.8772</td><td align="right">0.6425</td><td align="right">-1.37</td><td align="right">0.1721</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 045 &amp; kc1</td><td align="right">-5.3764</td><td align="right">0.6538</td><td align="right">-8.22</td><td align="right">&lt;1e-15</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 050 &amp; kc1</td><td align="right">2.8526</td><td align="right">0.6336</td><td align="right">4.50</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 050 &amp; kc1</td><td align="right">-2.9337</td><td align="right">0.6501</td><td align="right">-4.51</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 055 &amp; kc1</td><td align="right">3.9498</td><td align="right">0.6332</td><td align="right">6.24</td><td align="right">&lt;1e-09</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 055 &amp; kc1</td><td align="right">-1.6426</td><td align="right">0.6360</td><td align="right">-2.58</td><td align="right">0.0098</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 060 &amp; kc1</td><td align="right">5.9748</td><td align="right">0.6433</td><td align="right">9.29</td><td align="right">&lt;1e-19</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 060 &amp; kc1</td><td align="right">-2.5006</td><td align="right">0.6424</td><td align="right">-3.89</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 065 &amp; kc1</td><td align="right">5.1583</td><td align="right">0.6371</td><td align="right">8.10</td><td align="right">&lt;1e-15</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 065 &amp; kc1</td><td align="right">-5.3304</td><td align="right">0.6392</td><td align="right">-8.34</td><td align="right">&lt;1e-16</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 070 &amp; kc1</td><td align="right">4.7393</td><td align="right">0.6266</td><td align="right">7.56</td><td align="right">&lt;1e-13</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 070 &amp; kc1</td><td align="right">-6.6672</td><td align="right">0.6340</td><td align="right">-10.52</td><td align="right">&lt;1e-25</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 075 &amp; kc1</td><td align="right">4.3813</td><td align="right">0.6283</td><td align="right">6.97</td><td align="right">&lt;1e-11</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 075 &amp; kc1</td><td align="right">-6.5044</td><td align="right">0.6272</td><td align="right">-10.37</td><td align="right">&lt;1e-24</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 080 &amp; kc1</td><td align="right">3.2995</td><td align="right">0.6329</td><td align="right">5.21</td><td align="right">&lt;1e-06</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 080 &amp; kc1</td><td align="right">-4.5391</td><td align="right">0.6265</td><td align="right">-7.25</td><td align="right">&lt;1e-12</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 085 &amp; kc1</td><td align="right">3.4179</td><td align="right">0.6276</td><td align="right">5.45</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 085 &amp; kc1</td><td align="right">-1.1781</td><td align="right">0.6267</td><td align="right">-1.88</td><td align="right">0.0601</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 090 &amp; kc1</td><td align="right">2.7855</td><td align="right">0.6292</td><td align="right">4.43</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 090 &amp; kc1</td><td align="right">1.1149</td><td align="right">0.6270</td><td align="right">1.78</td><td align="right">0.0754</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 095 &amp; kc1</td><td align="right">2.5044</td><td align="right">0.6272</td><td align="right">3.99</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 095 &amp; kc1</td><td align="right">2.6390</td><td align="right">0.6280</td><td align="right">4.20</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 100 &amp; kc1</td><td align="right">1.8771</td><td align="right">0.6274</td><td align="right">2.99</td><td align="right">0.0028</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 100 &amp; kc1</td><td align="right">3.3892</td><td align="right">0.6286</td><td align="right">5.39</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 105 &amp; kc1</td><td align="right">1.2351</td><td align="right">0.6277</td><td align="right">1.97</td><td align="right">0.0491</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 105 &amp; kc1</td><td align="right">3.5273</td><td align="right">0.6277</td><td align="right">5.62</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 110 &amp; kc1</td><td align="right">0.7451</td><td align="right">0.6279</td><td align="right">1.19</td><td align="right">0.2354</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 110 &amp; kc1</td><td align="right">3.1548</td><td align="right">0.6279</td><td align="right">5.02</td><td align="right">&lt;1e-06</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 000 &amp; kc2</td><td align="right">0.8548</td><td align="right">0.0292</td><td align="right">29.28</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 000 &amp; kc2</td><td align="right">0.8101</td><td align="right">0.0275</td><td align="right">29.44</td><td align="right">&lt;1e-99</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 001 &amp; kc2</td><td align="right">0.4245</td><td align="right">0.0288</td><td align="right">14.76</td><td align="right">&lt;1e-48</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 001 &amp; kc2</td><td align="right">0.4536</td><td align="right">0.0274</td><td align="right">16.54</td><td align="right">&lt;1e-60</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 005 &amp; kc2</td><td align="right">0.5131</td><td align="right">0.0313</td><td align="right">16.37</td><td align="right">&lt;1e-59</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 005 &amp; kc2</td><td align="right">0.3057</td><td align="right">0.0319</td><td align="right">9.58</td><td align="right">&lt;1e-21</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 010 &amp; kc2</td><td align="right">0.1190</td><td align="right">0.0308</td><td align="right">3.86</td><td align="right">0.0001</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 010 &amp; kc2</td><td align="right">0.1534</td><td align="right">0.0283</td><td align="right">5.41</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 015 &amp; kc2</td><td align="right">-0.0689</td><td align="right">0.0285</td><td align="right">-2.42</td><td align="right">0.0157</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 015 &amp; kc2</td><td align="right">-0.3395</td><td align="right">0.0269</td><td align="right">-12.60</td><td align="right">&lt;1e-35</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 020 &amp; kc2</td><td align="right">-0.1961</td><td align="right">0.0287</td><td align="right">-6.82</td><td align="right">&lt;1e-11</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 020 &amp; kc2</td><td align="right">-0.4771</td><td align="right">0.0277</td><td align="right">-17.23</td><td align="right">&lt;1e-65</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 025 &amp; kc2</td><td align="right">-0.0902</td><td align="right">0.0267</td><td align="right">-3.38</td><td align="right">0.0007</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 025 &amp; kc2</td><td align="right">-0.4366</td><td align="right">0.0279</td><td align="right">-15.64</td><td align="right">&lt;1e-54</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 030 &amp; kc2</td><td align="right">-0.2104</td><td align="right">0.0261</td><td align="right">-8.05</td><td align="right">&lt;1e-15</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 030 &amp; kc2</td><td align="right">-0.5272</td><td align="right">0.0260</td><td align="right">-20.31</td><td align="right">&lt;1e-90</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 035 &amp; kc2</td><td align="right">-0.2293</td><td align="right">0.0257</td><td align="right">-8.92</td><td align="right">&lt;1e-18</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 035 &amp; kc2</td><td align="right">-0.4534</td><td align="right">0.0236</td><td align="right">-19.18</td><td align="right">&lt;1e-81</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 040 &amp; kc2</td><td align="right">-0.2313</td><td align="right">0.0238</td><td align="right">-9.72</td><td align="right">&lt;1e-21</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 040 &amp; kc2</td><td align="right">-0.5029</td><td align="right">0.0243</td><td align="right">-20.66</td><td align="right">&lt;1e-94</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 045 &amp; kc2</td><td align="right">-0.3612</td><td align="right">0.1246</td><td align="right">-2.90</td><td align="right">0.0038</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 045 &amp; kc2</td><td align="right">-1.2815</td><td align="right">0.1270</td><td align="right">-10.09</td><td align="right">&lt;1e-23</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 050 &amp; kc2</td><td align="right">0.3375</td><td align="right">0.1231</td><td align="right">2.74</td><td align="right">0.0061</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 050 &amp; kc2</td><td align="right">-0.8504</td><td align="right">0.1262</td><td align="right">-6.74</td><td align="right">&lt;1e-10</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 055 &amp; kc2</td><td align="right">0.4992</td><td align="right">0.1231</td><td align="right">4.05</td><td align="right">&lt;1e-04</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 055 &amp; kc2</td><td align="right">-0.5935</td><td align="right">0.1236</td><td align="right">-4.80</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 060 &amp; kc2</td><td align="right">0.8634</td><td align="right">0.1254</td><td align="right">6.88</td><td align="right">&lt;1e-11</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 060 &amp; kc2</td><td align="right">-0.7089</td><td align="right">0.1249</td><td align="right">-5.68</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 065 &amp; kc2</td><td align="right">0.6858</td><td align="right">0.1241</td><td align="right">5.53</td><td align="right">&lt;1e-07</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 065 &amp; kc2</td><td align="right">-1.2334</td><td align="right">0.1243</td><td align="right">-9.92</td><td align="right">&lt;1e-22</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 070 &amp; kc2</td><td align="right">0.6079</td><td align="right">0.1220</td><td align="right">4.98</td><td align="right">&lt;1e-06</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 070 &amp; kc2</td><td align="right">-1.4730</td><td align="right">0.1233</td><td align="right">-11.94</td><td align="right">&lt;1e-32</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 075 &amp; kc2</td><td align="right">0.5590</td><td align="right">0.1223</td><td align="right">4.57</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 075 &amp; kc2</td><td align="right">-1.4475</td><td align="right">0.1220</td><td align="right">-11.86</td><td align="right">&lt;1e-31</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 080 &amp; kc2</td><td align="right">0.3896</td><td align="right">0.1233</td><td align="right">3.16</td><td align="right">0.0016</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 080 &amp; kc2</td><td align="right">-1.0562</td><td align="right">0.1220</td><td align="right">-8.66</td><td align="right">&lt;1e-17</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 085 &amp; kc2</td><td align="right">0.4426</td><td align="right">0.1222</td><td align="right">3.62</td><td align="right">0.0003</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 085 &amp; kc2</td><td align="right">-0.3962</td><td align="right">0.1220</td><td align="right">-3.25</td><td align="right">0.0012</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 090 &amp; kc2</td><td align="right">0.3525</td><td align="right">0.1225</td><td align="right">2.88</td><td align="right">0.0040</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 090 &amp; kc2</td><td align="right">0.0667</td><td align="right">0.1221</td><td align="right">0.55</td><td align="right">0.5849</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 095 &amp; kc2</td><td align="right">0.3312</td><td align="right">0.1222</td><td align="right">2.71</td><td align="right">0.0067</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 095 &amp; kc2</td><td align="right">0.3840</td><td align="right">0.1223</td><td align="right">3.14</td><td align="right">0.0017</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 100 &amp; kc2</td><td align="right">0.2488</td><td align="right">0.1222</td><td align="right">2.04</td><td align="right">0.0418</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 100 &amp; kc2</td><td align="right">0.5545</td><td align="right">0.1225</td><td align="right">4.53</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 105 &amp; kc2</td><td align="right">0.1605</td><td align="right">0.1223</td><td align="right">1.31</td><td align="right">0.1892</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 105 &amp; kc2</td><td align="right">0.6077</td><td align="right">0.1223</td><td align="right">4.97</td><td align="right">&lt;1e-06</td><td align="right"> </td></tr><tr><td align="left">gender: Female &amp; age: 110 &amp; kc2</td><td align="right">0.0903</td><td align="right">0.1223</td><td align="right">0.74</td><td align="right">0.4602</td><td align="right"> </td></tr><tr><td align="left">gender: Male &amp; age: 110 &amp; kc2</td><td align="right">0.5545</td><td align="right">0.1223</td><td align="right">4.53</td><td align="right">&lt;1e-05</td><td align="right"> </td></tr><tr><td align="left">Residual</td><td align="right">0.0419</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
<pre><code class="language-julia hljs"># Predict and compute residuals for the reduced model
df_filtered.fitted = predict(m2)
df_filtered.residuals = residuals(m2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">12187-element Vector{Float64}:
  0.013522619460105467
  0.0735004457788011
 -0.01234834997010692
  0.09374611522544196
 -0.008375547504021696
 -0.07160018737189766
  0.04358055002676897
 -0.07961945113080615
 -0.06484621171658622
 -0.02051638464717831
  ⋮
  0.04214211436267676
  0.002754024168788227
 -0.0016135032001408367
  0.005887557001143212
 -0.011767079382243084
  0.0007219523697565844
 -0.016234782891470928
 -0.004725943939585364
 -0.025642950799068698</code></pre><p>Scatter plot to check for <code>heteroskedasticity</code></p><pre><code class="language-julia hljs">Gadfly.plot(
    df_filtered,
    x=:fitted,
    y=:residuals,
    Geom.point,
   Gadfly.Theme(discrete_highlight_color=x -&gt; &quot;red&quot;, default_color=&quot;white&quot;),
   Guide.xlabel(&quot;Fitted Values&quot;),
   Guide.ylabel(&quot;Residuals&quot;),
   Guide.title(&quot;Scatter Plot for Heteroskedasticity&quot;)
)</code></pre><img src="ba22cbef.svg" alt="Example block output"/><pre><code class="language-julia hljs"># QQ plot for residuals
Gadfly.plot(
    df_filtered,
    x=:residuals,
    y=Normal(mean(df_filtered[!, :residuals]), std(df_filtered[!, :residuals])),
    Stat.qq,
    Geom.point,
    Gadfly.Theme(discrete_highlight_color=c -&gt; nothing, alphas=[0.5], point_size=2pt),
    Guide.xlabel(&quot;Theoretical Quantiles&quot;),
    Guide.ylabel(&quot;Sample Quantiles&quot;),
    Guide.title(&quot;Normal QQ Plot of Clamped Residuals&quot;)
)</code></pre><img src="6ffd5061.svg" alt="Example block output"/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p><a href="https://juliastats.org/MixedModels.jl/stable/constructors/#Examples-of-linear-mixed-effects-model-fits">Examples of linear mixed-effects model fits</a></p><p><a href="https://www.jstor.org/stable/3448650">Analysis of Variance: Why It Is More Important than Ever</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../bootstrap/">Parametric bootstrap for LMEASDRs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 15 January 2024 05:46">Monday 15 January 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
